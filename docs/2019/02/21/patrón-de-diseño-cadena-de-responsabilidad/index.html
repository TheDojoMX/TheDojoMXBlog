<!doctype html><html lang=es dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Patrón de diseño: Cadena de responsabilidad | The Dojo MX Blog</title>
<link rel=icon href=/favicon.svg sizes=any type=image/svg+xml><meta property="og:title" content="Patrón de diseño: Cadena de responsabilidad"><meta property="og:description" content="Manejar múltiples handlers, conocidos y no conocidos."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.thedojo.mx/2019/02/21/patr%C3%B3n-de-dise%C3%B1o-cadena-de-responsabilidad/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-02-21T00:00:00+00:00"><meta property="article:modified_time" content="2019-02-21T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Patrón de diseño: Cadena de responsabilidad"><meta name=twitter:description content="Manejar múltiples handlers, conocidos y no conocidos."><link rel=stylesheet href=/css/extended.min.771dff75f9f3290205d2bfcbeda2ed15a5984c0414d431dfec3423ae5e37bb90.css integrity="sha256-dx3/dfnzKQIF0r/L7aLtFaWYTAQU1DHf7DQjrl43u5A=" crossorigin=anonymous><link rel=stylesheet href=/css/root.min.0e732b812b9751962e01a7c4798a1211cd5f8ac8abec7f99793fe306989e459f.css integrity="sha256-DnMrgSuXUZYuAafEeYoSEc1fisir7H+ZeT/jBpieRZ8=" crossorigin=anonymous><link rel=stylesheet href=/css/bundle.min.59eb1a059f8cd558e64375ede3e68d3e9120ddb0c6bdbab555c247689cef59e1.css integrity="sha256-WesaBZ+M1VjmQ3Xt4+aNPpEg3bDGvbq1VcJHaJzvWeE=" crossorigin=anonymous><script src=/js/bundle.cc8ae9952dbfb731affafabdf26e5c60a6910047ff59ccdeaf1daebaa26c8830.js integrity="sha256-zIrplS2/tzGv+vq98m5cYKaRAEf/Wczerx2uuqJsiDA=" crossorigin=anonymous></script><script defer src=/js/search/flexsearch.compact.64594b125f7b78bdf4fa8316955922bbebb1cd6baef3f16654bfca20309f18f8.js integrity="sha256-ZFlLEl97eL30+oMWlVkiu+uxzWuu8/FmVL/KIDCfGPg="></script><script defer src=/js/search/search.1d980f84df11f3eb7c8c5f17f541d49a0611608df179dd74fa7f06225eb56ace.js integrity="sha256-HZgPhN8R8+t8jF8X9UHUmgYRYI3xed10+n8GIl61as4="></script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,200..800&family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel=stylesheet></head><body class=notransition><div id=container><header id=main-header><div role=navigation aria-label=Main><div class=nav-left><a href=https://blog.thedojo.mx/ style=color:inherit>The Dojo MX Blog</a></div><div class=nav-right><div style=position:absolute;width:0;height:0><div id=nav-dropdown-menu class=hidden href=#><div class=nav-item><a aria-current=true class=ancestor href=/posts/>Posts</a></div><div class=nav-item><a>Acerca de</a></div></div></div><a id=nav-dropdown-button href=#><svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 6H20M4 12H20M4 18H20" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></a><div id=nav-menu><div class=nav-item><a aria-current=true class=ancestor href=/posts/>Posts</a></div><div class=nav-item><a>Acerca de</a></div></div><a id=theme-switcher href=#><svg class="light-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 3V4m0 16v1M4 12H3M6.31412 6.31412 5.5 5.5m12.1859.81412L18.5 5.5M6.31412 17.69 5.5 18.5001M17.6859 17.69 18.5 18.5001M21 12H20m-4 0c0 2.2091-1.7909 4-4 4-2.20914.0-4-1.7909-4-4 0-2.20914 1.79086-4 4-4 2.2091.0 4 1.79086 4 4z" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg><svg class="dark-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.32031 11.6835c0 4.9706 4.02944 9 8.99999 9 3.7872.0 7.028-2.3392 8.3565-5.6515C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834c-4.9706.0-8.99999-4.0294-8.99999-8.99998C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996 5.65605 4.66028 3.32031 7.89912 3.32031 11.6835z" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></a></div></div></header><div class="flex grow"><div id=main-pane><main id=main-content><div class=single-header><ol class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=https://blog.thedojo.mx/><span itemprop=name>Home</span>
</a><meta itemprop=position content='1'></li><span>&nbsp»&nbsp</span><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=https://blog.thedojo.mx/posts/><span itemprop=name>Posts</span>
</a><meta itemprop=position content='2'></li><span>&nbsp»&nbsp</span></ol><h1>Patrón de diseño: Cadena de responsabilidad</h1><time class=dim datetime=2019-02-21T00:00:00+00:00>February 21, 2019</time><div class=term-container><div class=tag><a href=https://blog.thedojo.mx/tags/python/>#python</a></div><div class=tag><a href=https://blog.thedojo.mx/tags/patrones/>#patrones</a></div><div class=tag><a href=https://blog.thedojo.mx/tags/solid/>#solid</a></div><div class=tag><a href=https://blog.thedojo.mx/tags/chain-of-responsibility/>#Chain-of-Responsibility</a></div><div class=tag><a href=https://blog.thedojo.mx/tags/design-patterns/>#design-patterns</a></div></ol></div><section class=page-section><h4 id=propósito>Propósito</h4><blockquote><p>Asegurar el bajo acoplamiento entre un <em>request</em> y su <em>receiver</em> dando a múltiples objetos oportunidad de manejar el <em>request</em></p></blockquote><p>Hace unas semanas me enfrenté a un tema de procesar un mensaje de un usuario y darle tratamiento por medio de un algoritmo de Natrual Language Processing. Antes de pasar el mensaje por el set de algoritmos apropiados hay que darle una serie de tratamientos previos:</p><ol><li>Eliminar los acentos y solo dejar en ASCII el mensaje.</li><li>Pasar el mensaje a lowercase.</li></ol><p>A primera luz, un código que puede fácilmente satisfacer es:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>message <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Dios bendiga a los héroes que nos dieron el internet.&#34;</span>
</span></span><span style=display:flex><span>message <span style=color:#f92672>=</span> message<span style=color:#f92672>.</span>lower()
</span></span><span style=display:flex><span>message <span style=color:#f92672>=</span> message<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;á&#34;</span>,<span style=color:#e6db74>&#34;a&#34;</span>)<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;é&#34;</span>,<span style=color:#e6db74>&#34;e&#34;</span>) \
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;í&#34;</span>,<span style=color:#e6db74>&#34;i&#34;</span>)<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;ó&#34;</span>,<span style=color:#e6db74>&#34;o&#34;</span>)<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;ú&#34;</span>,<span style=color:#e6db74>&#34;u&#34;</span>)
</span></span><span style=display:flex><span>print(message)
</span></span><span style=display:flex><span><span style=color:#75715e># dios bendiga a los heroes que nos dieron el internet.</span>
</span></span></code></pre></div><p>Funcionó, se cumplió el objetivo.</p><p>El problema sobrevino en el momento que los algoritmos posteriores requieren más modificaciones en la cadena original.
Poco a poco se fue agregando y agregando código para tareas como eliminar emojis, eliminar signos de puntuación, contraer palabras como <em>hooooooola</em> en <em>hola</em> y en el futuro no se sabe que más cosas habrá que hacer a la cadena original, pueden ser cosas tan diversas como &ldquo;A cada cadena que se procese quiero que se quede un historial de la cadena original&rdquo;, en ese momento hay que ir a reescribir código quebrantando el principio <a href=https://en.wikipedia.org/wiki/Open%E2%80%93closed_principle><strong><strong>open/closed</strong></strong></a> &ldquo;<em>software entities (classes, modules, functions, etc.) should be open for extension, but closed for modification</em>&rdquo;.</p><h4 id=solución>Solución</h4><p>El patrón de diseño <em>Chain of responsibility</em> como premisa principal es que más de una entidad de software (clase y/o función) pueda atender una petición. Dichas entidades pueden ser conocidas y de hecho se acaban implementando, pero también pueden ser desconocidas y esas no las podemos implementar pero debemos ser capaces de implementarlas en un futuro.</p><p>Pero, si el código anterior es muy sencillo, no veo caso de hacerlo <em>complejo</em>; a medida que los requerimientos van cambiando en el tiempo es muy probable que ese código se acabe agrupando en una función y esa función no hará más que crecer y entre más lo haga perderá el foco y se convertirá en una función que hará de todo, no cumplirá con otro principio (<a href=https://refactoring.guru/images/patterns/content/chain-of-responsibility/chain-of-responsibility.png>single responsibility</a>) <em>una entidad debe hacer solo una cosa y hacerla bien</em>, la función además de escribir en disco tiene que pasar la frase a minúsculas, reemplazar caracteres no ASCII con caracteres ASCII por mencionar algo. El partir una gran función (gran ~= muchas responsabilidades) en muchas más pequeñas facilita la escritura de test unitarios y propicia a la re usabilidad de esa función en distintas partes de nuestro proyecto principalmente.</p><p>En este patrón la petición (<em>request</em>) es mandada de entidad en entidad (cada entidad es un eslabón de la cadena o <em>handler</em>), cada entidad maneja la petición y la pasa al siguiente eslabón hasta que se terminen los eslabones de la cadena o uno de ellos decida que hay que regresar un valor.</p><p><img src=/assets/images/chain-of-responsibility.jpg alt="Representación gráfica"></p><p>Siguiendo con el problema original, el código propuesto es el siguiente <a href=https://www.tutorialspoint.com/design_pattern/chain_of_responsibility_pattern.htm>(aquí uno en Java)</a>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>to_lower</span>(message<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> isinstance(message,str):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>ValueError</span>(<span style=color:#e6db74>&#34;Message is not a string&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> message<span style=color:#f92672>.</span>strip()<span style=color:#f92672>.</span>lower()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>to_ascii</span>(message):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> isinstance(message,str):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>ValueError</span>(<span style=color:#e6db74>&#34;Message is not a string&#34;</span>)
</span></span><span style=display:flex><span>    message <span style=color:#f92672>=</span> message<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;á&#34;</span>,<span style=color:#e6db74>&#34;a&#34;</span>)<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;é&#34;</span>,<span style=color:#e6db74>&#34;e&#34;</span>)<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;í&#34;</span>,<span style=color:#e6db74>&#34;i&#34;</span>)<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;ó&#34;</span>,<span style=color:#e6db74>&#34;o&#34;</span>)<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;ú&#34;</span>,<span style=color:#e6db74>&#34;u&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> message
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>to_disk</span>(message):
</span></span><span style=display:flex><span>    FILENAME <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;historial.log&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> isinstance(message,str):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>ValueError</span>(<span style=color:#e6db74>&#34;Message is not a string&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(FILENAME,<span style=color:#e6db74>&#34;a&#34;</span>,encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;UTF-8&#34;</span>) <span style=color:#66d9ef>as</span> fp:
</span></span><span style=display:flex><span>        fp<span style=color:#f92672>.</span>write(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>message<span style=color:#e6db74>}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> message
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>remove_all_punctuation</span>(message):
</span></span><span style=display:flex><span>    <span style=color:#75715e>#all code to remove punctuation marks</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> message
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Pipe</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self,message):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_message <span style=color:#f92672>=</span> message
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>processors <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>add_process</span>(self,process_function):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>processors<span style=color:#f92672>.</span>append(process_function)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>run</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> process <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>processors:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>_message <span style=color:#f92672>=</span> process(self<span style=color:#f92672>.</span>_message)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>_message
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pipe<span style=color:#f92672>=</span>Pipe(<span style=color:#e6db74>&#34;Dios bendiga a los héroes que nos dieron el internet.&#34;</span>)
</span></span><span style=display:flex><span>pipe<span style=color:#f92672>.</span>add_process(to_disk)
</span></span><span style=display:flex><span>pipe<span style=color:#f92672>.</span>add_process(to_lower)
</span></span><span style=display:flex><span>pipe<span style=color:#f92672>.</span>add_process(to_ascii)
</span></span><span style=display:flex><span>pipe<span style=color:#f92672>.</span>add_process(remove_all_punctuation)
</span></span><span style=display:flex><span>new_message<span style=color:#f92672>=</span>pipe<span style=color:#f92672>.</span>run()
</span></span><span style=display:flex><span>print(new_message)
</span></span></code></pre></div><p>El código anterior es un código más profesional, más fácil de mantener ya que cumplimos con el principio <em>open/closed</em> y de paso de responsabilidad única.</p><p>Podemos ir agregando funciones de procesamiento de manera más legible, también podemos quitarlas a voluntad dado que el nivel de acoplamiento es muy bajo. A todo ésto hay que añadir la ventaja de facilidad al escribir test unitarios que dan pie para el CI/CD.</p><p>Se puede pensar al inicio que es una sobre-ingeniería para algo tan sencillo, pero los negocios son tan cambiantes en el tiempo que se vuelve un poco ingenuo pensar que lo que escribamos nunca lo tendremos que modificar, ¿Por qué no diseñar software que pueda ser modificable en el ahora y el futuro?. Este tema de los patrones de diseño es un tema muy extenso que poco a poco iremos cubriendo con entradas en este blog dando ejemplos sencillos como el anterior.</p><p>Lo importante es quedarse con el concepto de qué es lo que hace el patrón y no con la implementación como tal del código, en Java el código anterior puede ser muy diferente, sin embargo cumple el patrón. Tuve conciencia de esto leyendo que en un principio, en los años dorados de C, este patrón se implementaba con listas enlazadas,a su vez implementadas con apuntadores.</p><p>Saludos y no dudes en ejercer tu derecho de réplica :) , discutamos un poco al respecto :D.</p></section></main><footer id=main-footer><div class=footer><a href=#>Scroll to Top</a><div class=footer-copyright><div class=dim>© 2025 Héctor Patricio</div><div>Made with ❤️ and powered by <a href=https://github.com/math-queiroz/rusty-typewriter target=_blank>Rusty Typewriter</a> theme for <a href=https://gohugo.io/ target=_blank>Hugo</a></div></div></div></footer></div><aside id=side-pane class=side-sticky><div class=side-details><span>833 words</span>
<span>5 - 7 minutes read</span></div><h3>Table Of Contents</h3><nav id=TableOfContents><ul><li><ul><li></li></ul></li></ul></nav></aside></div></div></body></html>