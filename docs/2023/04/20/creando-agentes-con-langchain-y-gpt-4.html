<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="es" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Creando agentes con LangChain y GPT-4 - The Dojo MX Blog</title>
<meta name="description" content="Ya vimos como empezar a usar LangChain, avancemos a algo m√°s interesante: crear agentes que puedan interactuar con el exterior.">


  <meta name="author" content="H√©ctor Patricio">
  
  <meta property="article:author" content="H√©ctor Patricio">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="es">
<meta property="og:site_name" content="The Dojo MX Blog">
<meta property="og:title" content="Creando agentes con LangChain y GPT-4">
<meta property="og:url" content="https://blog.thedojo.mx/2023/04/20/creando-agentes-con-langchain-y-gpt-4.html">


  <meta property="og:description" content="Ya vimos como empezar a usar LangChain, avancemos a algo m√°s interesante: crear agentes que puedan interactuar con el exterior.">



  <meta property="og:image" content="https://res.cloudinary.com/hectorip/image/upload/c_scale,q_54,w_1200/v1681776700/DALL_E_2023-04-14_23.49.15_-_a_parrot_in_a_cybernetic_setting_plotting_a_great_plan_to_conquer_the_universe_digital_art_digital_illustration_detailed_cinematic_lightning_pkrwml.jpg">





  <meta property="article:published_time" content="2023-04-20T00:00:00-06:00">






<link rel="canonical" href="https://blog.thedojo.mx/2023/04/20/creando-agentes-con-langchain-y-gpt-4.html">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": null,
      "url": "https://blog.thedojo.mx/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="The Dojo MX Blog Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    
<!-- favicon -->
<link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/images/favicons/site.webmanifest">
<link rel="mask-icon" href="/assets/images/favicons/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="/assets/images/favicons/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/images/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
<!-- end favicon -->
<!-- for mathjax support -->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZNSYMJDY5S"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-ZNSYMJDY5S');
</script>

<!-- Hotjar Tracking Code for blog.thedojo.mx -->
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:1217463,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>

<script src="/assets/js/sharect.min.js"></script>

<script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BlogPosting",
      "url": "https://blog.thedojo.mx/2023/04/20/creando-agentes-con-langchain-y-gpt-4.html",
      "name": "Creando agentes con LangChain y GPT-4",
      "headline": "Creando agentes con LangChain y GPT-4",
      "keywords": "langchain,gpt4,agentes",
      "description": "Ya vimos como empezar a usar LangChain, avancemos a algo m√°s interesante: crear agentes que puedan interactuar con el exterior.",
      "articleBody": "En este peque√±o tutorial vamos a hablar de c√≥mo puedes crear agentes que interact√∫en con el mundo exterior, usando LangChain y como modelo de lenguaje GPT-4. Como siempre, la mejor manera de aprender es haciendo algo, por lo que vamos a crear un agente\n\n¬øQu√© es un agente?\n\nEn este contexto, adem√°s de una cosa que puede actuar por s√≠ mismo, se entiende que un agente puede hacer dos cosas m√°s:\n\n\n  Decidir qu√© hacer y qu√© herramienta usar\n  Aprender a usar herramientas autom√°ticamente (si le proporcionas las cosas que necesita)\n\n\nLos agentes tradicionalmente se entienden como programas que trabajan de manera aut√≥noma y con su propio espacio de memoria, con los que te comunicas por medio de mensajes, pero que no tienes el control completo sobre ellos. Un agente puede decidir qu√© hacer con tu mensaje.\n\nCombinando ambos contextos, un agente es un pedazo del programa que act√∫a aut√≥nomamente, que decide c√≥mo lograr lo que has pedido y que aprende a hacerlo por su cuenta. Al estar basado en un LLM, no est√° garantizado su √©xito.\n\nAgentes en LangChain\n\nLangChain provee de un conjunto de agentes prefabricados. Los m√°s f√°ciles de usar est√°n basados en un framework llamado ReAct, que propone una forma de crear estos agentes. Puedes ver el documento en el que se habla de ReAct en el siguiente documento: ReAct: Synergizing Reasoning and Acting in Language Models\n.\n\nB√°sicamente este framework da las gu√≠as para crear agentes que usen herramientas de manera efectiva. LangChain provee tres agentes b√°sicos:\n\n\n  \n    zero-shot-react-description: este tipo de agentes determinan qu√© tipo de herramientas usar bas√°ndose en la descripci√≥n de las herramientas proporcionadas.\n  \n  \n    react-docstore: basado completamente en el framework ReAct, este tipo de agentes usan herramientas para buscar documentos y luego buscar t√©rminos en esos documentos. Recibe una herramienta de b√∫squeda y una de consulta.\n  \n  \n    self-ask-with-search: utiliza una sola herramienta llamada ‚ÄòIntermediate Answer‚Äô que debe ser capaz de buscar respuestas correctas a preguntas. En el paper original de ReAct se usa Google como herramienta de b√∫squeda.\n  \n  \n    conversational-react-description: est√° pensado para ser usado de manera conversacional, puede decidir qu√© herramienta usar y tiene memoria para recordar lo que ya se ha hablado.\n  \n\n\nCreando un agente\n\nEl siguiente c√≥digo crea un agente que puede usar herramientas para lograr sus objetivos:\n\n # Creando un agente con LangChain\n\nfrom langchain.agents import load_tools\nfrom langchain.agents import initialize_agent\nfrom langchain.agents import AgentType\nfrom langchain.llms import OpenAI\n\nllm = OpenAI(temperature=0)\n\ntools = load_tools([\"serpapi\", \"llm-math\"], llm=llm)\n\nagent = initialize_agent(\n    tools, llm, agent=AgentType.ZERO_SHOT_REACT_DESCRIPTION, verbose=True\n)\n\nprint(\"Este agente puede buscar en Google y hacer aritm√©tica b√°sica.\")\nwhile True:\n    query = input(\"Pregunta algo: \")\n    if not query:\n        break\n    print(agent.run(query))\n\n\n\nEl c√≥digo anterior es suficiente para crear una agente que tiene dos capacidades: buscar en internet con Google y hacer operaciones matem√°ticas b√°sicas. El c√≥digo es bastante simple, pero vamos a explicarlo paso a paso.\n\nComo siempre, la primera parte es importar las funciones y tipos necesarios:\n\nfrom langchain.agents import load_tools # Es una funci√≥n que te ayuda a cargar las herramientas que los agentes ser√°n capaces de usar\n\nfrom langchain.agents import initialize_agent # Es una funci√≥n que te ayuda a crear un agente de manera sencilla\n\nfrom langchain.agents import AgentType # Es un tipo que te ayuda a especificar el tipo de agente que quieres crear, contiene todos los tipos de agentes que LangChain provee\n\nfrom langchain.llms import OpenAI # Es la clase que abstrae la conexi√≥n con el LLM que usaremos: GPT, creado por OpenAI\n\n\n\nDespu√©s, creamos una instancia de conexi√≥n con el LLM:\n\nllm = OpenAI(temperature=0)\n\n\nEl que le digamos que queremos cero de temperatura significa que la respuesta ser√° menos aleatoria, por lo que podemos pensar que ser√° menos ‚Äúcreativa‚Äù o arriesgada. Esto es buena idea cuando quieres crear planes, usar herramientas con una interfaz formal, como una API. Para poder usarlo, tienes que poner en el entorno de ejecuci√≥n la variable de entorno OPENAI_API_KEY con tu API key de OpenAI.\n\nSeguido de esto, cargamos las herramientas que queremos que el agente pueda usar, indicando el modelo de lenguaje que usar√° para interactuar con ellas:\n\ntools = load_tools([\"serpapi\", \"llm-math\"], llm=llm)\n\n\nLa primera es una herramienta para buscar en Google, se llama SerpApi, y permite usar la b√∫squeda que nosotros hacemos en Google mediante una interfaz m√°s amigable para programas. La versi√≥n gratuita te da 100 b√∫squedas mensuales.\n\nLa segunda herramienta, llm-math, tiene como objetivo permitir que el agente haga matem√°ticas b√°sicas, aunque tampoco est√°n garantizadas porque se ejecuta c√≥digo que el LLM devuelve. El prompt que usa es (lo traduzco a espa√±ol despu√©s):\n\nYou are GPT-3, and you can't do math.\n\nYou can do basic math, and your memorization abilities are\nimpressive, but you can't do any complex calculations that\na human could not do in their head. You also have an annoying\ntendency to just make up highly specific, but wrong, answers.\n\nSo we hooked you up to a Python 3 kernel, and now you can execute\ncode. If you execute code, you must print out the final answer\nusing the print function. You MUST use the python package\nnumpy to answer your question. You must import numpy as np.\n\n\nQuestion: ${Question with hard calculation.}\n\n```python\n${Code that prints what you need to know}\nprint(${code})\n```\n```output\n${Output of your code}\n```\nAnswer: $\n\nBegin.\n\nQuestion: What is 37593 * 67?\n\n```python\nimport numpy as np\nprint(np.multiply(37593, 67))\n```\n```output\n2518731\n```\nAnswer: 2518731\n\nQuestion: {question}\n\n\n\nTraducido al espa√±ol:\n\n\nEres GPT-3, y no puedes hacer matem√°ticas.\n\nPuedes hacer matem√°ticas b√°sicas, y tus habilidades de\nmemorizaci√≥n son impresionantes, pero no puedes hacer ning√∫n\nc√°lculo complejo que un humano no pudiera hacer en su cabeza.\nTambi√©n tienes una tendencia molesta a inventar respuestas\nespec√≠ficas, pero incorrectas.\n\nAs√≠ que te conectamos a un kernel de Python 3, y ahora puedes\nejecutar c√≥digo. Si ejecutas c√≥digo, debes imprimir el resultado\nfinal usando la funci√≥n print. DEBES usar el paquete Python\nnumpy para responder tu pregunta. Debes importar numpy como np.\n\nPregunta: ${Pregunta con c√°lculos duros.}\n\n```python\n${C√≥digo que imprime lo que necesitas saber}\nprint(${c√≥digo})\n```\n```output\n${Salida de tu c√≥digo}\n```\n```\nRespuesta: ${Respuesta}\n\nComienza.\n\nPregunta: ¬øCu√°nto es 37593 * 67?\n\n```python\nimport numpy as np\nprint(np.multiply(37593, 67))\n```\n```output\n2518731\n```\nRespuesta: 2518731\n\nPregunta: {Pregunta}\n\n\nEste m√≥dulo despu√©s extrae la respuesta de la salida del LLM y la ejecuta en un ejecutor de Python y extrae de aqu√≠ la respuesta.\n\nAunque por ser un ejecutor de Python tenemos garantizado que el c√°lculo es correcto, no tenemos garantizado que el c√≥digo introducido sea adecuado, as√≠ que no conf√≠es siempre en sus c√°lculos.\n\nDespu√©s de eso inicializamos un agente, al que le pasamos las herramientas que usar√°, el modelo de lenguaje y el tipo de agente que queremos crear. Adem√°s, le decimos que escriba en la salida est√°ndar todo su proceso con la opci√≥n verbose=True:\n\nagent = initialize_agent(\n    tools,\n    llm,\n    agent=AgentType.ZERO_SHOT_REACT_DESCRIPTION,\n    verbose=True\n)\n\n\nDe este modo LangChain har√° todo lo necesario para inicializar un agente que use act√∫e de manera aut√≥noma. Ahora le podemos preguntar cosas:\n\nprint(\"Este agente puede buscar en Google y hacer aritm√©tica b√°sica.\")\n\n# Creamos un loop para que\n\nwhile True:\n    query = input(\"Pregunta algo: \")\n    if not query:\n        break\n    print(agent.run(query))\n\n\nRecuerda que esto puede contestar preguntas que se puedan encontrar en internet y hacer aritm√©tica.\n\nConclusi√≥n\n\nEn este tutorial hemos visto c√≥mo crear un agente b√°sico. Falta explorar los dem√°s tipos de agentes, as√≠ como las dem√°s herramientas que LangChain provee para que podamos crear agentes m√°s complejos y funcionales. Adem√°s, hay que probar con diferentes agentes y ver c√≥mo se comportan.\n",
      "datePublished": "2023-04-20 00:00:00 -0600",
      "dateModified": "2023-04-20 00:00:00 -0600",
      "author": {
        "@type": "Person",
        "name": "H√©ctor Patricio",
        "givenName": "H√©ctor Patricio",
        "email": null
      },
      "publisher": {
        "@type": "Organization",
        "name": "The Dojo MX Blog",
        "url": "https://blog.thedojo.mx",
        "logo": {
          "@type": "ImageObject",
          "width": 32,
          "height": 32,
          "url": "https://blog.thedojo.mx/icon/favicon.ico"
        }
      },
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://blog.thedojo.mx/2023/04/20/creando-agentes-con-langchain-y-gpt-4.html"
      },
      "image": {
        "@type": "ImageObject",
        "width": 1200,
        "height": 400,
        "url": "https://res.cloudinary.com/hectorip/image/upload/c_scale,q_54,w_1200/v1681776700/DALL_E_2023-04-14_23.49.15_-_a_parrot_in_a_cybernetic_setting_plotting_a_great_plan_to_conquer_the_universe_digital_art_digital_illustration_detailed_cinematic_lightning_pkrwml.jpg"
      }
    }
</script>



  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="https://res.cloudinary.com/hectorip/image/upload/v1554098427/TheDojo/the-dojo-transparent.png" alt="The Dojo MX Blog"></a>
        
        <a class="site-title" href="/">
          The Dojo MX Blog
          
        </a>
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/latest">Todos los posts</a>
            </li>
<li class="masthead__menu-item">
              <a href="/about">Acerca de</a>
            </li>
<li class="masthead__menu-item">
              <a href="https://thedojo.mx">Cursos</a>
            </li>
</ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  







<div class="page__hero--overlay" style=" background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://res.cloudinary.com/hectorip/image/upload/c_scale,q_54,w_1200/v1681776700/DALL_E_2023-04-14_23.49.15_-_a_parrot_in_a_cybernetic_setting_plotting_a_great_plan_to_conquer_the_universe_digital_art_digital_illustration_detailed_cinematic_lightning_pkrwml.jpg');">
  
    <div class="wrapper">
      <h1 id="page-title" class="page__title" itemprop="headline">
        
          Creando agentes con LangChain y GPT-4

        
      </h1>
      
        <p class="page__lead">Ya vimos como empezar a usar LangChain, avancemos a algo m√°s interesante: crear agentes que puedan interactuar con el exterior.
</p>
      
      

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
        1251 palabras | 10 minutos de lectura
        
      </span>
    
  </p>

      
      
    </div>
  
  
</div>







<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/me.jpg" alt="H√©ctor Patricio" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">H√©ctor Patricio</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Tech Leader en Automata</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Seguir</button>
    <ul class="author__urls social-icons">
      

      

      
        <li>
          <a href="https://github.com/hectorip" itemprop="url">
            <i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Sitio web</span>
          </a>
        </li>
      

      
        <li>
          <a href="mailto:hectorivanpatriciomoreno@gmail.com">
            <meta itemprop="email" content="hectorivanpatriciomoreno@gmail.com">
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
          </a>
        </li>
      

      

      
        <li>
          <a href="https://twitter.com/hectorip" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Creando agentes con LangChain y GPT-4">
    <meta itemprop="description" content="Ya vimos como empezar a usar LangChain, avancemos a algo m√°s interesante: crear agentes que puedan interactuar con el exterior.">
    <meta itemprop="datePublished" content="2023-04-20T00:00:00-06:00">
    

    <div class="page__inner-wrap">
      

      <section class="page__content e-content" itemprop="text">
        
        <div style="border: 1px solid gray; border-radius: 4px; margin: 20px; padding: 5px;">
          Visita nuestro canal de YouTube para encontrar temas similares en video:<a href="https://youtube.com/thedojomx"> The Dojo MX en YouTube </a>

        </div>
        <p>En este peque√±o tutorial vamos a hablar de c√≥mo puedes crear agentes que interact√∫en con el mundo exterior, usando LangChain y como modelo de lenguaje GPT-4. Como siempre, la mejor manera de aprender es haciendo algo, por lo que vamos a crear un agente</p>

<h3 id="qu√©-es-un-agente">¬øQu√© es un agente?</h3>

<p>En este contexto, adem√°s de una cosa que puede actuar por s√≠ mismo, se entiende que un agente puede hacer dos cosas m√°s:</p>

<ul>
  <li>Decidir qu√© hacer y qu√© herramienta usar</li>
  <li>Aprender a usar herramientas autom√°ticamente (si le proporcionas las cosas que necesita)</li>
</ul>

<p>Los agentes tradicionalmente se entienden como programas que trabajan de manera aut√≥noma y con su propio espacio de memoria, con los que te comunicas por medio de mensajes, pero que no tienes el control completo sobre ellos. Un agente puede decidir qu√© hacer con tu mensaje.</p>

<p>Combinando ambos contextos, un agente es un pedazo del programa que act√∫a aut√≥nomamente, que decide c√≥mo lograr lo que has pedido y que aprende a hacerlo por su cuenta. Al estar basado en un LLM, no est√° garantizado su √©xito.</p>

<h2 id="agentes-en-langchain">Agentes en LangChain</h2>

<p><strong>LangChain</strong> provee de un conjunto de agentes prefabricados. Los m√°s f√°ciles de usar est√°n basados en un framework llamado ReAct, que propone una forma de crear estos agentes. Puedes ver el documento en el que se habla de ReAct en el siguiente documento: <strong><a href="https://arxiv.org/abs/2210.03629">ReAct: Synergizing Reasoning and Acting in Language Models
</a></strong>.</p>

<p>B√°sicamente este framework da las gu√≠as para crear agentes que usen herramientas de manera efectiva. LangChain provee tres agentes b√°sicos:</p>

<ul>
  <li>
    <p><strong>zero-shot-react-description</strong>: este tipo de agentes determinan qu√© tipo de herramientas usar bas√°ndose en la descripci√≥n de las herramientas proporcionadas.</p>
  </li>
  <li>
    <p><strong>react-docstore</strong>: basado completamente en el framework ReAct, este tipo de agentes usan herramientas para buscar documentos y luego buscar t√©rminos en esos documentos. Recibe una herramienta de b√∫squeda y una de consulta.</p>
  </li>
  <li>
    <p><strong>self-ask-with-search</strong>: utiliza una sola herramienta llamada ‚ÄòIntermediate Answer‚Äô que debe ser capaz de buscar respuestas correctas a preguntas. En el paper original de ReAct se usa Google como herramienta de b√∫squeda.</p>
  </li>
  <li>
    <p><strong>conversational-react-description</strong>: est√° pensado para ser usado de manera conversacional, puede decidir qu√© herramienta usar y tiene memoria para recordar lo que ya se ha hablado.</p>
  </li>
</ul>

<h3 id="creando-un-agente">Creando un agente</h3>

<p>El siguiente c√≥digo crea un agente que puede usar herramientas para lograr sus objetivos:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1"># Creando un agente con LangChain
</span>
<span class="kn">from</span> <span class="nn">langchain.agents</span> <span class="kn">import</span> <span class="n">load_tools</span>
<span class="kn">from</span> <span class="nn">langchain.agents</span> <span class="kn">import</span> <span class="n">initialize_agent</span>
<span class="kn">from</span> <span class="nn">langchain.agents</span> <span class="kn">import</span> <span class="n">AgentType</span>
<span class="kn">from</span> <span class="nn">langchain.llms</span> <span class="kn">import</span> <span class="n">OpenAI</span>

<span class="n">llm</span> <span class="o">=</span> <span class="n">OpenAI</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">tools</span> <span class="o">=</span> <span class="n">load_tools</span><span class="p">([</span><span class="s">"serpapi"</span><span class="p">,</span> <span class="s">"llm-math"</span><span class="p">],</span> <span class="n">llm</span><span class="o">=</span><span class="n">llm</span><span class="p">)</span>

<span class="n">agent</span> <span class="o">=</span> <span class="n">initialize_agent</span><span class="p">(</span>
    <span class="n">tools</span><span class="p">,</span> <span class="n">llm</span><span class="p">,</span> <span class="n">agent</span><span class="o">=</span><span class="n">AgentType</span><span class="p">.</span><span class="n">ZERO_SHOT_REACT_DESCRIPTION</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span>
<span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"Este agente puede buscar en Google y hacer aritm√©tica b√°sica."</span><span class="p">)</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Pregunta algo: "</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">query</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="k">print</span><span class="p">(</span><span class="n">agent</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">query</span><span class="p">))</span>

</code></pre></div></div>

<p>El c√≥digo anterior es suficiente para crear una agente que tiene dos capacidades: buscar en internet con Google y hacer operaciones matem√°ticas b√°sicas. El c√≥digo es bastante simple, pero vamos a explicarlo paso a paso.</p>

<p>Como siempre, la primera parte es importar las funciones y tipos necesarios:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">langchain.agents</span> <span class="kn">import</span> <span class="n">load_tools</span> <span class="c1"># Es una funci√≥n que te ayuda a cargar las herramientas que los agentes ser√°n capaces de usar
</span>
<span class="kn">from</span> <span class="nn">langchain.agents</span> <span class="kn">import</span> <span class="n">initialize_agent</span> <span class="c1"># Es una funci√≥n que te ayuda a crear un agente de manera sencilla
</span>
<span class="kn">from</span> <span class="nn">langchain.agents</span> <span class="kn">import</span> <span class="n">AgentType</span> <span class="c1"># Es un tipo que te ayuda a especificar el tipo de agente que quieres crear, contiene todos los tipos de agentes que LangChain provee
</span>
<span class="kn">from</span> <span class="nn">langchain.llms</span> <span class="kn">import</span> <span class="n">OpenAI</span> <span class="c1"># Es la clase que abstrae la conexi√≥n con el LLM que usaremos: GPT, creado por OpenAI
</span>
</code></pre></div></div>

<p>Despu√©s, creamos una instancia de conexi√≥n con el LLM:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">llm</span> <span class="o">=</span> <span class="n">OpenAI</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<p>El que le digamos que queremos cero de temperatura significa que la respuesta ser√° menos aleatoria, por lo que podemos pensar que ser√° menos ‚Äúcreativa‚Äù o arriesgada. Esto es buena idea cuando quieres crear planes, usar herramientas con una interfaz formal, como una API. Para poder usarlo, tienes que poner en el entorno de ejecuci√≥n la variable de entorno <code class="language-plaintext highlighter-rouge">OPENAI_API_KEY</code> con tu API key de OpenAI.</p>

<p>Seguido de esto, cargamos las herramientas que queremos que el agente pueda usar, indicando el modelo de lenguaje que usar√° para interactuar con ellas:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tools</span> <span class="o">=</span> <span class="n">load_tools</span><span class="p">([</span><span class="s">"serpapi"</span><span class="p">,</span> <span class="s">"llm-math"</span><span class="p">],</span> <span class="n">llm</span><span class="o">=</span><span class="n">llm</span><span class="p">)</span>
</code></pre></div></div>

<p>La primera es una herramienta para buscar en Google, se llama <a href="https://serpapi.com/">SerpApi</a>, y permite usar la b√∫squeda que nosotros hacemos en Google mediante una interfaz m√°s amigable para programas. La versi√≥n gratuita te da 100 b√∫squedas mensuales.</p>

<p>La segunda herramienta, <code class="language-plaintext highlighter-rouge">llm-math</code>, tiene como objetivo permitir que el agente haga matem√°ticas b√°sicas, aunque tampoco est√°n garantizadas porque se ejecuta c√≥digo que el LLM devuelve. El prompt que usa es (lo traduzco a espa√±ol despu√©s):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>You are GPT-3, and you can't do math.

You can do basic math, and your memorization abilities are
impressive, but you can't do any complex calculations that
a human could not do in their head. You also have an annoying
tendency to just make up highly specific, but wrong, answers.

So we hooked you up to a Python 3 kernel, and now you can execute
code. If you execute code, you must print out the final answer
using the print function. You MUST use the python package
numpy to answer your question. You must import numpy as np.


Question: ${Question with hard calculation.}

```python
${Code that prints what you need to know}
print(${code})
```
```output
${Output of your code}
```
Answer: $

Begin.

Question: What is 37593 * 67?

```python
import numpy as np
print(np.multiply(37593, 67))
```
```output
2518731
```
Answer: 2518731

Question: {question}

</code></pre></div></div>

<p>Traducido al espa√±ol:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Eres GPT-3, y no puedes hacer matem√°ticas.

Puedes hacer matem√°ticas b√°sicas, y tus habilidades de
memorizaci√≥n son impresionantes, pero no puedes hacer ning√∫n
c√°lculo complejo que un humano no pudiera hacer en su cabeza.
Tambi√©n tienes una tendencia molesta a inventar respuestas
espec√≠ficas, pero incorrectas.

As√≠ que te conectamos a un kernel de Python 3, y ahora puedes
ejecutar c√≥digo. Si ejecutas c√≥digo, debes imprimir el resultado
final usando la funci√≥n print. DEBES usar el paquete Python
numpy para responder tu pregunta. Debes importar numpy como np.

Pregunta: ${Pregunta con c√°lculos duros.}

```python
${C√≥digo que imprime lo que necesitas saber}
print(${c√≥digo})
```
```output
${Salida de tu c√≥digo}
```
```
Respuesta: ${Respuesta}

Comienza.

Pregunta: ¬øCu√°nto es 37593 * 67?

```python
import numpy as np
print(np.multiply(37593, 67))
```
```output
2518731
```
Respuesta: 2518731

Pregunta: {Pregunta}
</code></pre></div></div>

<p>Este m√≥dulo despu√©s extrae la respuesta de la salida del LLM y la ejecuta en un ejecutor de Python y extrae de aqu√≠ la respuesta.</p>

<p>Aunque por ser un ejecutor de Python tenemos garantizado que el c√°lculo es correcto, no tenemos garantizado que el c√≥digo introducido sea adecuado, as√≠ que no conf√≠es siempre en sus c√°lculos.</p>

<p>Despu√©s de eso inicializamos un agente, al que le pasamos las herramientas que usar√°, el modelo de lenguaje y el tipo de agente que queremos crear. Adem√°s, le decimos que escriba en la salida est√°ndar todo su proceso con la opci√≥n <code class="language-plaintext highlighter-rouge">verbose=True</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">agent</span> <span class="o">=</span> <span class="n">initialize_agent</span><span class="p">(</span>
    <span class="n">tools</span><span class="p">,</span>
    <span class="n">llm</span><span class="p">,</span>
    <span class="n">agent</span><span class="o">=</span><span class="n">AgentType</span><span class="p">.</span><span class="n">ZERO_SHOT_REACT_DESCRIPTION</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span>
<span class="p">)</span>
</code></pre></div></div>

<p>De este modo LangChain har√° todo lo necesario para inicializar un agente que use act√∫e de manera aut√≥noma. Ahora le podemos preguntar cosas:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"Este agente puede buscar en Google y hacer aritm√©tica b√°sica."</span><span class="p">)</span>

<span class="c1"># Creamos un loop para que
</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Pregunta algo: "</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">query</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="k">print</span><span class="p">(</span><span class="n">agent</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">query</span><span class="p">))</span>
</code></pre></div></div>

<p>Recuerda que esto puede contestar preguntas que se puedan encontrar en internet y hacer aritm√©tica.</p>

<h2 id="conclusi√≥n">Conclusi√≥n</h2>

<p>En este tutorial hemos visto c√≥mo crear un agente b√°sico. Falta explorar los dem√°s tipos de agentes, as√≠ como las dem√°s herramientas que LangChain provee para que podamos crear agentes m√°s complejos y funcionales. Adem√°s, hay que probar con diferentes agentes y ver c√≥mo se comportan.</p>

       <div style="border: 1px solid gray; border-radius: 4px; margin: 20px; padding: 5px;">
          Visita nuestro canal de YouTube para encontrar temas similares en video:<a href="https://youtube.com/thedojomx"> The Dojo MX en YouTube </a>
        </div>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Etiquetas: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#agentes" class="page__taxonomy-item" rel="tag">agentes</a><span class="sep">, </span>
    
      <a href="/tags/#gpt4" class="page__taxonomy-item" rel="tag">gpt4</a><span class="sep">, </span>
    
      <a href="/tags/#langchain" class="page__taxonomy-item" rel="tag">langchain</a>
    
    </span>
  </p>




        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Actualizado:</strong> <time datetime="2023-04-20T00:00:00-06:00">April 20, 2023</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Compartir</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Creando+agentes+con+LangChain+y+GPT-4%20https%3A%2F%2Fblog.thedojo.mx%2F2023%2F04%2F20%2Fcreando-agentes-con-langchain-y-gpt-4.html" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Compartir Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fblog.thedojo.mx%2F2023%2F04%2F20%2Fcreando-agentes-con-langchain-y-gpt-4.html" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Compartir Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fblog.thedojo.mx%2F2023%2F04%2F20%2Fcreando-agentes-con-langchain-y-gpt-4.html" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Compartir LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/2023/04/17/instrumentando-microservicios-con-X-Ray.html" class="pagination--pager" title="Instrumentando microservicios en Go con Gin y AWS X-Ray
">Anterior</a>
    
    
      <a href="/2023/04/22/el-principio-de-inversion-de-dependencias.html" class="pagination--pager" title="El principio de Inversi√≥n de Dependencias
">Siguiente</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
      <h4 class="page__comments-title">Comentar</h4>
      <section id="disqus_thread"></section>
    
</div>

    
  </article>

  
  
    <div class="page__related">
      <h2 class="page__related-title">Podr√≠as ver tambi√©n</h2>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="https://res.cloudinary.com/hectorip/image/upload/c_scale,w_1400/v1682052442/milad-fakurian-PGdW_bHDbpI-unsplash_teqmvg.jpg" alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2023/04/22/el-principio-de-inversion-de-dependencias.html" rel="permalink">El principio de Inversi√≥n de Dependencias
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




10 minutos de lectura



| <i class="far fa-calendar" aria-hidden="true"></i> 22-04-2023
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Analicemos el principio de Inversi√≥n de Dependencias, el √∫ltimo principio de SOLID y veamos si conviene, adem√°s cu√°ndo aplicarlo.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="https://res.cloudinary.com/hectorip/image/upload/c_scale,w_400/v1681785117/cam-c9WkEaPBqLI-unsplash_tdzflr.jpg" alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2023/04/17/instrumentando-microservicios-con-X-Ray.html" rel="permalink">Instrumentando microservicios en Go con Gin y AWS X-Ray
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




17 minutos de lectura



| <i class="far fa-calendar" aria-hidden="true"></i> 17-04-2023
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Descubre c√≥mo mejorar la observabilidad de tus microservicios en Go con X-Ray.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="https://res.cloudinary.com/hectorip/image/upload/c_scale,w_1200/v1679150874/sam-moghadam-khamseh-VwHzE0aFQfY-unsplash_lpqwqn.jpg" alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2023/04/17/composicion-en-el-software.html" rel="permalink">Composici√≥n en el software
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




10 minutos de lectura



| <i class="far fa-calendar" aria-hidden="true"></i> 17-04-2023
</p>
    
    <p class="archive__item-excerpt" itemprop="description">La composici√≥n es algo muy mencionado en la programaci√≥n funcional, vamos a ver c√≥mo se aplica al desarrollo de software tambi√©n fuera de ella.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="https://res.cloudinary.com/hectorip/image/upload/c_crop,g_face,h_550,w_1024/v1681538471/DALL_E_2023-04-14_23.53.02_-_a_green_parrot_in_a_cybernetic_setting_plotting_a_plan_to_conquer_the_universe_digital_illustration_detailed_cinematic_light_ff6lm8.png" alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2023/04/15/usando-langchain-para-crear-software-basado-en-llm-s.html" rel="permalink">Usando LangChain ü¶ú para crear software basado en LLM‚Äôs
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




9 minutos de lectura



| <i class="far fa-calendar" aria-hidden="true"></i> 15-04-2023
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Vamos a ver c√≥mo funciona LangChain, una herramienta que le puede dar o√≠dos, ojos y manos a tu modelo de lenguaje preferido.
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap">
<form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term...">
  </form>
  <div id="results" class="results"></div>
</div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        
<script>
    var sharect = new Sharect();
    sharect.config({
    //   facebook: true,
      twitter: true,
      twitterUsername: '@thedojomx',
      backgroundColor: '#ff4081',
      iconColor: '#fff'
    }).init();

</script>
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Seguir:</strong></li>
    

    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">¬© 2023 The Dojo MX Blog. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




  <script>
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-127437335-2']);
  
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>






    
  <script>
    var disqus_config = function () {
      this.page.url = "https://blog.thedojo.mx/2023/04/20/creando-agentes-con-langchain-y-gpt-4.html";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/2023/04/20/creando-agentes-con-langchain-y-gpt-4"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://the-dojo-mx-blog.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>


  





  </body>
</html>
